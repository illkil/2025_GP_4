<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Dashboard · Flagged Reports</title>
<script src="https://code.iconify.design/3/3.1.0/iconify.min.js"></script>
<style>
  :root{
    --sidebar:#F6F6F5;
    --text:#000;
    --muted40: rgba(0,0,0,.4);
    --muted50: rgba(0,0,0,.5);
    --select-bg: rgba(0,0,0,.04);
    --divider: rgba(180,188,201,.8);
    --approve:#65A65B;
    --reject:#A65B5B;
    --toast-bg:#fff;
    --toast-border: rgba(0,0,0,.12);
    --toast-shadow: 0 6px 24px rgba(0,0,0,.08);
  }
  *{ box-sizing:border-box; }
  html, body { height:100%; }
  body{ margin:0; font-family:"Segoe UI", Arial, sans-serif; color:var(--text); overflow:hidden; background:#fff; }

  .app{ display:flex; height:100vh; width:100%; }

  /* Sidebar */
  .sidebar{
    position: relative; /* anchor for profile popover */
    width:240px; background:var(--sidebar);
    display:flex; flex-direction:column; gap:12px; padding:12px;
    height:100vh; overflow:hidden;
  }
  .brand-link{ text-decoration:none; color:inherit; }
  .brand{ display:flex; align-items:center; gap:10px; padding:10px; border-radius:12px; cursor:pointer; }
  .brand:hover{ background: var(--select-bg); }
  .brand img{ width:32px; height:32px; border-radius:8px; object-fit:cover; }
  .brand .name{ font-size:16px; font-weight:700; }
  .section-label{ font-size:12px; color:var(--muted40); margin:6px 10px 0; }
  .nav{ display:flex; flex-direction:column; gap:6px; padding:4px; }
  .nav-item{ padding:10px; border-radius:12px; cursor:pointer; color:#000; text-decoration:none; }
  .nav-item.selected{ background: var(--select-bg); }
  .nav-item:hover{ background:rgba(0,0,0,.06); }
  .spacer{ flex:1 1 auto; }
  .profile{ display:flex; align-items:center; gap:10px; padding:10px; border-radius:12px; cursor:pointer; }
  .profile:hover{ background:rgba(0,0,0,.06); }
  .profile img{ width:32px; height:32px; border-radius:50%; object-fit:cover; background:#ddd; }
  .profile .pname{ font-size:14px; }

  /* Profile Popover */
  .profile-popover{
    position: absolute;
    bottom: 64px;
    left: 12px;
    width:210px; height:115px;
    background:#fff;
    border:1px solid rgba(0,0,0,.12);
    border-radius:12px;
    box-shadow:0 8px 24px rgba(0,0,0,.10);
    padding:10px;
    display:none;
    z-index:50;
  }
  .profile-popover.show{ display:block; }
  .pp-item{ display:flex; align-items:center; gap:10px; padding:8px; border-radius:8px; cursor:pointer; font-size:16px; color:#000; }
  .pp-item .iconify{ width:18px; height:18px; color:#4b5563; }
  .pp-item:hover{ background:rgba(0,0,0,.05); }
  .pp-divider{ height:1px; background:rgba(0,0,0,.12); margin:6px 4px; }

  /* Content */
  .content{
    flex:1; display:flex; flex-direction:column;
    padding:18px 24px 8px; min-width:0; min-height:0; position:relative;
  }
  .header{
    display:flex; align-items:center; justify-content:space-between;
    padding-right:8px; margin-bottom:12px;
    position:relative; /* anchor sort popover */
  }
  .crumbs{ font-size:16px; display:flex; gap:6px; align-items:center; }
  .crumbs .dim{ color:var(--muted40); }
  .crumbs .sep{ color:var(--muted40); }
  .sort-btn{
    background:none; border:none; cursor:pointer; padding:10px; color:#000; border-radius:8px;
  }
  .sort-btn:hover{ background:rgba(0,0,0,.04); }
  .sort-btn .iconify{ width:32px; height:32px; }

  /* Sort Popover */
  .sort-panel{
    position:absolute;
    top:calc(100% + 8px);
    right:0;
    width:245px; height:130px;
    background:#fff;
    border:1px solid rgba(0,0,0,.12);
    border-radius:12px;
    box-shadow:0 8px 24px rgba(0,0,0,.10);
    padding:10px;
    display:none;
    z-index:10;
  }
  .sort-panel.show{ display:block; }
  .sort-panel-header{ display:flex; align-items:center; gap:8px; padding:2px 6px 6px; }
  .sort-panel-title{ font-size:16px; font-weight:700; color:#000; }
  .sort-panel-close{ margin-left:auto; border:none; background:transparent; cursor:pointer; padding:4px; border-radius:6px; color:#6b7280; }
  .sort-panel-close:hover{ background:rgba(0,0,0,.06); }
  .sort-list{ display:flex; flex-direction:column; gap:6px; margin-top:2px; }
  .sort-item{ display:flex; align-items:center; gap:10px; padding:8px 8px; border-radius:8px; cursor:pointer; font-size:16px; color: rgba(0,0,0,.8); }
  .sort-item .iconify{ width:18px; height:18px; color:#4b5563; }
  .sort-item:hover{ background:rgba(0,0,0,.05); }

  /* Only the list scrolls */
  .reports-wrap{ flex:1; min-height:0; overflow-y:auto; padding-right:8px; }
  .report{ padding:20px 0; border-bottom:1px solid var(--divider); }
  .report:last-child{ border-bottom:none; }

  .report-row{
    display:grid; grid-template-columns: 1fr 50px; align-items:center; gap:16px;
    cursor:pointer; /* row click toggles too */
  }
  .r-title{ font-size:24px; font-weight:700; margin:0 0 8px; color:#000; }
  .r-reason{ font-size:22px; margin:0 0 8px; color:#000; }
  .r-date{ font-size:22px; color:var(--muted50); margin:0; }

  .chevron-btn{
    width:50px; height:50px; display:flex; align-items:center; justify-content:center;
    border:none; background:transparent; cursor:pointer; border-radius:8px; transition:background .15s ease;
  }
  .chevron-btn:hover{ background:rgba(0,0,0,.04); }
  .chevron{ color:#7D848D; width:50px; height:50px; transition: transform .2s ease; }
  .report[aria-expanded="true"] .chevron{ transform: rotate(180deg); }

  /* Details */
  .details{ margin-top:16px; padding:16px 0 4px; display:none; }
  .report[aria-expanded="true"] .details{ display:block; }

  /* Details grid: image | text | flexible spacer | actions (right) */
  .details-grid{
    display:grid;
    grid-template-columns: 250px 390px 1fr auto;
    gap:20px; align-items:start;
    width:100%;
  }

  .detail-image{ width:250px; height:250px; object-fit:cover; border-radius:8px; background:#eee; }

  .field{ width:390px; }
  .label{ font-size:20px; font-weight:700; margin:0; display:inline; }
  .value.title{ font-size:20px; font-weight:400; line-height:25px; display:inline; }
  .value.desc{ font-size:18px; line-height:1.45; margin-top:8px; width:390px; }

  .actions{
    display:flex; gap:14px; align-self:start; justify-self:end;
  }
  .btn{
    width:150px; height:50px; border:none; border-radius:8px; color:#fff;
    font-size:20px; font-weight:600; cursor:pointer;
  }
  .btn-approve{ background:var(--approve); }
  .btn-reject{ background:var(--reject); }
  .btn:hover{ filter:brightness(.96); }
  .btn:focus-visible{ outline:2px solid rgba(0,0,0,.4); outline-offset:2px; }

  /* Toast */
  .toast-wrap{
    position:fixed; top:18px; left:50%; transform:translateX(-50%);
    z-index:999; pointer-events:none;
  }
  .toast{
    background:var(--toast-bg);
    border:1px solid var(--toast-border);
    box-shadow: var(--toast-shadow);
    border-radius:12px;
    min-width:360px; max-width:560px;
    padding:14px 16px;
    display:flex; align-items:flex-start; gap:12px;
    opacity:0; translate:0 -10px;
    transition:opacity .18s ease, translate .18s ease;
    pointer-events:auto;
  }
  .toast.show{ opacity:1; translate:0 0; }
  .toast-title{ font-weight:700; margin:0 0 4px; }
  .toast-text{ margin:0; color:var(--muted50); }
  .toast-close{
    margin-left:auto; background:none; border:none; cursor:pointer; padding:4px;
    color:#6b7280; border-radius:6px;
  }
  .toast-close:hover{ background:rgba(0,0,0,.05); }
</style>
</head>
<body>

<div class="app">
  <!-- Sidebar -->
  <aside class="sidebar">
    <a class="brand-link" href="Wujed.html">
      <div class="brand">
        <img src="Images/Logo.png" alt="Wujed logo">
        <div class="name">Wujed</div>
      </div>
    </a>

    <div class="section-label">Dashboards</div>
    <nav class="nav">
      <a href="FlaggedReports.html" class="nav-item selected">Flagged Reports</a>
      <a href="RejectedMatches.html" class="nav-item">Rejected Matches</a>
    </nav>

    <div class="spacer"></div>

    <!-- Profile -->
    <div class="profile" id="profileBtn">
      <img src="Images/ProfilePic.jpg" alt="Profile">
      <div class="pname">Raneem</div>
    </div>

    <!-- Profile Popover -->
    <div class="profile-popover" id="profilePopover">
      <div class="pp-item" id="ppLang">
        <span class="iconify" data-icon="mdi:swap-horizontal"></span>
        <span>العربية</span>
      </div>
      <div class="pp-divider"></div>
      <div class="pp-item" id="ppLogout" style="font-weight:700;">
        <span class="iconify" data-icon="mdi:logout"></span>
        <span>Log Out</span>
      </div>
    </div>
  </aside>

  <!-- Content -->
  <main class="content">
    <div class="header">
      <div class="crumbs">
        <span class="dim">Dashboards</span>
        <span class="sep">/</span>
        <span>Flagged Reports</span>
      </div>
      <button class="sort-btn" aria-label="Sort">
        <span class="iconify" data-icon="mdi:tune-variant"></span>
      </button>

      <!-- Sort Panel -->
      <div class="sort-panel" id="sortPanel">
        <div class="sort-panel-header">
          <div class="sort-panel-title">Sort based on Date</div>
          <button class="sort-panel-close" id="sortClose" aria-label="Close">
            <span class="iconify" data-icon="mdi:close"></span>
          </button>
        </div>
        <div class="sort-list">
          <div class="sort-item" data-sort="date_desc">
            <span class="iconify" data-icon="mdi:sort-descending"></span>
            <span>Newest to Oldest</span>
          </div>
          <div class="sort-item" data-sort="date_asc">
            <span class="iconify" data-icon="mdi:sort-ascending"></span>
            <span>Oldest to Newest</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Toast -->
    <div class="toast-wrap" aria-live="polite"></div>

    <!-- Reports -->
    <div class="reports-wrap" role="list">
      <!-- Report 1 -->
      <article class="report" role="listitem" aria-expanded="false">
        <div class="report-row">
          <div class="row-click">
            <h3 class="r-title">RPT-000001</h3>
            <p class="r-reason">Reason: <span>Inappropriate Language</span></p>
            <p class="r-date">January 25, 2025 by <span>User123</span></p>
          </div>
          <button class="chevron-btn" aria-label="Expand/Collapse" tabindex="0">
            <span class="iconify chevron" data-icon="mdi:chevron-down"></span>
          </button>
        </div>

        <div class="details">
          <div class="details-grid">
            <img class="detail-image" src="Images/sample-item.jpg" alt="Reported item image">

            <div class="field">
              <p class="label">Title: </p><span class="value title">Coffee Brewer</span>
              <p class="label" style="display:block; margin-top:14px;">Description:</p>
              <div class="value desc">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
                Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
              </div>
            </div>

            <div class="actions">
              <button class="btn btn-approve" type="button">Approve</button>
              <button class="btn btn-reject" type="button">Reject</button>
            </div>
          </div>
        </div>
      </article>

      <!-- Report 2 -->
      <article class="report" role="listitem" aria-expanded="false">
        <div class="report-row">
          <div class="row-click">
            <h3 class="r-title">RPT-000002</h3>
            <p class="r-reason">Reason: <span>Suspicious Image</span></p>
            <p class="r-date">March 25, 2025 by <span>User123</span></p>
          </div>
          <button class="chevron-btn" aria-label="Expand/Collapse" tabindex="0">
            <span class="iconify chevron" data-icon="mdi:chevron-down"></span>
          </button>
        </div>

        <div class="details">
          <div class="details-grid">
            <img class="detail-image" src="Images/sample-item2.jpg" alt="Reported item image">

            <div class="field">
              <p class="label">Title: </p><span class="value title">Leather Wallet</span>
              <p class="label" style="display:block; margin-top:14px;">Description:</p>
              <div class="value desc">
                Compact brown wallet with multiple card slots and a slim profile. Minor scuff on one corner. Seen near the library entrance.
              </div>
            </div>

            <div class="actions">
              <button class="btn btn-approve" type="button">Approve</button>
              <button class="btn btn-reject" type="button">Reject</button>
            </div>
          </div>
        </div>
      </article>

      <!-- Add more reports ... -->
    </div>
  </main>
</div>

<script>
  /* ===== Profile popover ===== */
  const profileBtn = document.getElementById('profileBtn');
  const profilePanel = document.getElementById('profilePopover');
  function closeProfile(){ profilePanel.classList.remove('show'); }
  profileBtn.addEventListener('click',(e)=>{ e.stopPropagation(); profilePanel.classList.toggle('show'); });
  document.addEventListener('click',(e)=>{ if(!profilePanel.contains(e.target)&&!profileBtn.contains(e.target)){ closeProfile(); }});
  document.getElementById('ppLang')?.addEventListener('click',()=>{ closeProfile(); alert('Language switch to العربية (stub).'); });
  document.getElementById('ppLogout')?.addEventListener('click',()=>{ closeProfile(); if(confirm('Are you sure you want to log out?')){ window.location.href='login.html'; } });

  /* ===== Sort popover ===== */
  const sortBtn   = document.querySelector('.sort-btn');
  const sortPanel = document.getElementById('sortPanel');
  const sortClose = document.getElementById('sortClose');
  sortBtn.addEventListener('click', (e) => { e.stopPropagation(); sortPanel.classList.toggle('show'); });
  sortClose.addEventListener('click', (e) => { e.stopPropagation(); sortPanel.classList.remove('show'); });
  document.addEventListener('click', (e)=>{
    if (!sortPanel.contains(e.target) && !sortBtn.contains(e.target)) { sortPanel.classList.remove('show'); }
  });
  document.querySelectorAll('.sort-item').forEach(item => {
    item.addEventListener('click', () => {
      console.log('Selected sort:', item.dataset.sort); // hook to backend or DOM sort later
      sortPanel.classList.remove('show');
    });
  });

  /* ===== Expand/Collapse (chevron + row click) ===== */
  document.querySelectorAll('.report').forEach(report => {
    const toggle = () => {
      const expanded = report.getAttribute('aria-expanded') === 'true';
      report.setAttribute('aria-expanded', String(!expanded));
    };
    report.querySelector('.chevron-btn').addEventListener('click', (e) => { e.stopPropagation(); toggle(); });
    report.querySelector('.row-click').addEventListener('click', toggle);
  });

  /* ===== Toast + Removal on Approve/Reject ===== */
  const toastWrap = document.querySelector('.toast-wrap');
  let toastTimeout = null;
  function showToast(kind, code) {
    toastWrap.innerHTML = '';
    if (toastTimeout) clearTimeout(toastTimeout);
    const toast = document.createElement('div');
    toast.className = 'toast';
    const title = kind === 'approve' ? 'Report Approved!' : 'Report Rejected!';
    const body  = `${code} has been ${kind === 'approve'
      ? 'approved and will continue processing'
      : 'rejected and removed from processing'
    }.`;
    toast.innerHTML = `
      <div>
        <p class="toast-title">${title}</p>
        <p class="toast-text">${body}</p>
      </div>
      <button class="toast-close" aria-label="Dismiss">
        <span class="iconify" data-icon="mdi:close"></span>
      </button>
    `;
    toastWrap.appendChild(toast);
    requestAnimationFrame(() => toast.classList.add('show'));
    const close = () => { toast.classList.remove('show'); setTimeout(() => { toastWrap.innerHTML = ''; }, 180); };
    toast.querySelector('.toast-close').addEventListener('click', close);
    toastTimeout = setTimeout(close, 3500);
  }
  function removeReport(article) {
    article.style.transition = 'opacity .15s ease, height .2s ease, margin .2s ease, padding .2s ease';
    const h = article.getBoundingClientRect().height;
    article.style.height = h + 'px';
    requestAnimationFrame(() => {
      article.style.opacity = '0';
      article.style.height = '0px';
      article.style.margin = '0';
      article.style.paddingTop = '0';
      article.style.paddingBottom = '0';
      setTimeout(() => article.remove(), 220);
    });
  }
  document.querySelectorAll('.report').forEach(article => {
    const code = article.querySelector('.r-title')?.textContent?.trim() || 'This report';
    article.querySelector('.btn-approve')?.addEventListener('click', (e) => {
      e.stopPropagation();
      showToast('approve', code);
      removeReport(article);
    });
    article.querySelector('.btn-reject')?.addEventListener('click', (e) => {
      e.stopPropagation();
      showToast('reject', code);
      removeReport(article);
    });
  });
</script>

</body>
</html>
